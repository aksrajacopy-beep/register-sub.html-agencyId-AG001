<!DOCTYPE html>
<html>
<head>
  <title>Agency Dashboard</title>
  <style>
    body { font-family: Arial; padding: 20px; }
    input { padding: 8px; margin: 5px; width: 200px; }
    button { padding: 8px 15px; margin: 5px; }
    table { width: 100%; border-collapse: collapse; margin-top: 10px; }
    table, th, td { border: 1px solid #000; }
    th, td { padding: 8px; text-align: left; }
  </style>
</head>
<body>

  <h1>Agency Dashboard</h1>

  <div>
    <button onclick="showRegister()">Sub-Agency Register</button>
    <button onclick="showHost()">Add Host</button>
    <button onclick="showIncome()">Add Income</button>
    <button onclick="showDashboard()">Dashboard</button>
  </div>

  <div id="content"></div>

  <script>
    const API_URL = "https://script.google.com/macros/s/AKfycbx-iPNbGzLZ-bFxlSbW0BWVMRuPPZc6CDJRYZKnjeAV2upzA2ylbK_iwMyP88HkQZwzmQ/exec";

    function showRegister(){
      document.getElementById("content").innerHTML = `
        <h2>Sub-Agency Register</h2>
        <input id="subAgentId" placeholder="SubAgent ID"><br>
        <input id="agencyId" placeholder="Agency ID"><br>
        <input id="name" placeholder="Name"><br>
        <input id="password" placeholder="Password"><br>
        <button onclick="registerSubAgent()">Register</button>
      `;
    }

    function registerSubAgent(){
      const subAgentId = document.getElementById("subAgentId").value;
      const agencyId = document.getElementById("agencyId").value;
      const name = document.getElementById("name").value;
      const password = document.getElementById("password").value;

      fetch(`${API_URL}?action=addSubAgent&subAgentId=${subAgentId}&agencyId=${agencyId}&name=${name}&password=${password}`)
      .then(res => res.text())
      .then(data => alert(data));
    }

    function showHost(){
      document.getElementById("content").innerHTML = `
        <h2>Add Host</h2>
        <input id="hostId" placeholder="Host ID"><br>
        <input id="subAgentId2" placeholder="SubAgent ID"><br>
        <input id="hostName" placeholder="Host Name"><br>
        <button onclick="addHost()">Add</button>
      `;
    }

    function addHost(){
      const hostId = document.getElementById("hostId").value;
      const subAgentId = document.getElementById("subAgentId2").value;
      const name = document.getElementById("hostName").value;

      fetch(`${API_URL}?action=addHost&hostId=${hostId}&subAgentId=${subAgentId}&name=${name}`)
      .then(res => res.text())
      .then(data => alert(data));
    }

    function showIncome(){
      document.getElementById("content").innerHTML = `
        <h2>Add Income</h2>
        <input id="incomeId" placeholder="Income ID"><br>
        <input id="hostId2" placeholder="Host ID"><br>
        <input id="date" placeholder="Date"><br>
        <input id="points" placeholder="Points"><br>
        <input id="income" placeholder="Income"><br>
        <button onclick="addIncome()">Add</button>
      `;
    }

    function addIncome(){
      const incomeId = document.getElementById("incomeId").value;
      const hostId = document.getElementById("hostId2").value;
      const date = document.getElementById("date").value;
      const points = document.getElementById("points").value;
      const income = document.getElementById("income").value;

      fetch(`${API_URL}?action=addIncome&incomeId=${incomeId}&hostId=${hostId}&date=${date}&points=${points}&income=${income}`)
      .then(res => res.text())
      .then(data => alert(data));
    }

    function showDashboard(){
      document.getElementById("content").innerHTML = `
        <h2>Dashboard</h2>
        <button onclick="loadDashboard()">Load Data</button>
        <div id="dash"></div>
      `;
    }

    function loadDashboard(){
      fetch(`${API_URL}?action=getAll`)
      .then(res => res.json())
      .then(data => {
        let html = `<table>
          <tr>
            <th>Host ID</th>
            <th>Host Name</th>
            <th>SubAgent ID</th>
            <th>Points</th>
            <th>Income</th>
          </tr>`;

        data.forEach(item => {
          html += `<tr>
            <td>${item.hostId}</td>
            <td>${item.hostName}</td>
            <td>${item.subAgentId}</td>
            <td>${item.points}</td>
            <td>${item.income}</td>
          </tr>`;
        });

        html += `</table>`;
        document.getElementById("dash").innerHTML = html;
      });
    }
  </script>

</body>
</html>
